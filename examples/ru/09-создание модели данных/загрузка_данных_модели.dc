# –°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ model_data –∏ —Å–æ–∑–¥–∞–Ω–∏—è SQLite –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: datacode –∑–∞–≥—Ä—É–∑–∫–∞_–¥–∞–Ω–Ω—ã—Ö_–º–æ–¥–µ–ª–∏.dc --build_model

print("============================================================")
print("–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ model_data")
print("============================================================")
print()

# –ë–∞–∑–æ–≤—ã–π –ø—É—Ç—å –∫ –¥–∞–Ω–Ω—ã–º
let base_path = getcwd() / "model_data"
let docs_path = base_path / "docs"

print("üìÇ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤...")
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–∞–∫ null –Ω–∞ —Å–ª—É—á–∞–π –æ—à–∏–±–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏
global product_catalog = null
global regions = null
global employees = null

# –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
try {
    product_catalog = read_file(docs_path / "product_catalog.csv")
    print("  ‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤: ", len(product_catalog))
} catch e {
    print("  ‚ö†Ô∏è  –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ product_catalog.csv: ", e)
}

try {
    regions = read_file(docs_path / "regions.csv")
    print("  ‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ä–µ–≥–∏–æ–Ω–æ–≤: ", len(regions))
} catch e {
    print("  ‚ö†Ô∏è  –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ regions.csv: ", e)
}

try {
    employees = read_file(docs_path / "employees.csv")
    print("  ‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: ", len(employees))
} catch e {
    print("  ‚ö†Ô∏è  –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ employees.csv: ", e)
}
print()

# –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é merge_tables –∏–∑ DataCode

print("üìä –ó–∞–≥—Ä—É–∑–∫–∞ –µ–∂–µ–º–µ—Å—è—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö...")

# –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –µ–∂–µ–º–µ—Å—è—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
let all_sales_tables = []
let all_inventory_tables = []
let all_refunds_tables = []
let all_marketing_tables = []

# –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≥–æ–¥–∞
for year_dir in list_files(base_path) {
    # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Ñ–∞–π–ª—ã –∏ —Å–ª—É–∂–µ–±–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
    if year_dir.name != "docs" and !contains(year_dir.name, ".") {
        # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –º–µ—Å—è—Ü–µ–≤ –≤ –≥–æ–¥—É        
        print("  üîç –ì–æ–¥ ", year_dir.name)
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –º–µ—Å—è—Ü–∞
        for month_dir in sort(list_files(year_dir)) {
            if !month_dir.is_dir {
                continue
            }
            # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ —Ñ–∞–π–ª—ã
            print("     üîç –ú–µ—Å—è—Ü ", month_dir.name)
            if !contains(month_dir.name, "quarter_") {
                # month_dir –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "01", "02", ..., "12"
                for file in list_files(month_dir) {
                    # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ —Ñ–∞–π–ª—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏ (–∫—Ä–æ–º–µ CSV)
                    if contains(file.name, "quarter_") or (contains(file.name, ".") and !contains(file.name, ".csv")) {
                        print("         ‚ö†Ô∏è  –ü—Ä–æ–ø—É—â–µ–Ω (–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –∏–ª–∏ –Ω–µ CSV —Ñ–∞–π–ª): ", file.name)
                    } else {
                        print("         üîç —Ñ–∞–π–ª ", file.name)
                        try {
                            let data = read_file(file)
                            if contains(file.name, "sales") {
                                try {
                                    all_sales_tables = push(all_sales_tables, data)
                                } catch e {
                                    print("  ‚ö†Ô∏è  –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ", file, ": ", e)
                                }
                            } else if contains(file.name, "inventory") {
                                try {
                                    all_inventory_tables = push(all_inventory_tables, data)
                                } catch e {
                                    print("  ‚ö†Ô∏è  –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ", file, ": ", e)
                                }
                            } else if contains(file.name, "marketing_spend") {
                                try {
                                    all_marketing_tables = push(all_marketing_tables, data)
                                } catch e {
                                    print("  ‚ö†Ô∏è  –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ", file, ": ", e)
                                }
                            } else if contains(file.name, "refunds") {
                                try {
                                    all_refunds_tables = push(all_refunds_tables, data)
                                } catch e {
                                    print("  ‚ö†Ô∏è  –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ", file, ": ", e)
                                }
                            }
                        } catch e {
                            print("  ‚ö†Ô∏è  –û—à–∏–±–∫–∞ file ", file, ": ", e)
                        }
                    }
                }
            }
        }
    }
}

print("  ‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ñ–∞–π–ª–æ–≤ sales: ", len(all_sales_tables))
print("  ‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ñ–∞–π–ª–æ–≤ inventory: ", len(all_inventory_tables))
print("  ‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ñ–∞–π–ª–æ–≤ refunds: ", len(all_refunds_tables))
print("  ‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ñ–∞–π–ª–æ–≤ marketing: ", len(all_marketing_tables))
print()

# –û–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ –µ–∂–µ–º–µ—Å—è—á–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
print("üîó –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –µ–∂–µ–º–µ—Å—è—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö...")
print("  –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ sales (", len(all_sales_tables), " —Ç–∞–±–ª–∏—Ü)...")
global sales_all = merge_tables(all_sales_tables)
print("  –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ inventory (", len(all_inventory_tables), " —Ç–∞–±–ª–∏—Ü)...")
global inventory_all = merge_tables(all_inventory_tables)
print("  –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ refunds (", len(all_refunds_tables), " —Ç–∞–±–ª–∏—Ü)...")
global refunds_all = merge_tables(all_refunds_tables)
print("  –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ marketing (", len(all_marketing_tables), " —Ç–∞–±–ª–∏—Ü)...")
global marketing_spend_all = merge_tables(all_marketing_tables)

if sales_all != null {
    print("  ‚úì –û–±—ä–µ–¥–∏–Ω–µ–Ω–æ –ø—Ä–æ–¥–∞–∂: ", len(sales_all))
}
if inventory_all != null {
    print("  ‚úì –û–±—ä–µ–¥–∏–Ω–µ–Ω–æ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è: ", len(inventory_all))
}
if refunds_all != null {
    print("  ‚úì –û–±—ä–µ–¥–∏–Ω–µ–Ω–æ –≤–æ–∑–≤—Ä–∞—Ç–æ–≤: ", len(refunds_all))
}
if marketing_spend_all != null {
    print("  ‚úì –û–±—ä–µ–¥–∏–Ω–µ–Ω–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞: ", len(marketing_spend_all))
}
print()

# –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
print("üìà –ó–∞–≥—Ä—É–∑–∫–∞ –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã—Ö –∞–≥—Ä–µ–≥–∞—Ç–æ–≤...")
let all_financial_summary_tables = []
let all_regional_summary_tables = []
let all_product_summary_tables = []
let all_employee_performance_tables = []

# –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≥–æ–¥–∞ –¥–ª—è –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
for year_dir in list_files(base_path) {
    # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Ñ–∞–π–ª—ã –∏ —Å–ª—É–∂–µ–±–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
    if year_dir.name != "docs" and year_dir.is_dir {

        print("  üîç –ì–æ–¥ ", year_dir.name)
        
        # –ò—â–µ–º –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤–Ω—É—Ç—Ä–∏ –º–µ—Å—è—á–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
        for month_dir in sort(list_files(year_dir)) {
            if !month_dir.is_dir {
                continue
            }

            # –ò—â–µ–º –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤–Ω—É—Ç—Ä–∏ –º–µ—Å—è—á–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
            for item in list_files(month_dir) {
                if contains(item.name, "quarter_") {
                    print("     üîç –ú–µ—Å—è—Ü ", month_dir.name)
                    # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –≤ –∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
                    let quarter_files = null
                    try {
                        quarter_files = list_files(item)
                    } catch e {
                        # –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤ –∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
                        print("  ‚ö†Ô∏è  –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ ", item, ": ", e)
                        quarter_files = null
                    }
                    
                    if quarter_files != null {
                        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—ã–π —Ñ–∞–π–ª –≤ –∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
                        for quarter_file in quarter_files {
                            print("         üîç —Ñ–∞–π–ª ", quarter_file.name)
                            let data = read_file(quarter_file)

                            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø —Ñ–∞–π–ª–∞ –ø–æ –∏–º–µ–Ω–∏ –∏ –∑–∞–≥—Ä—É–∂–∞–µ–º
                            if contains(quarter_file.name, "financial_summary_") {
                                try {
                                    all_financial_summary_tables = push(all_financial_summary_tables, data)
                                } catch e {
                                    print("  ‚ö†Ô∏è  –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ", quarter_file, ": ", e)
                                }
                            }
                            
                            if contains(quarter_file.name, "regional_summary_") {
                                try {
                                    all_regional_summary_tables = push(all_regional_summary_tables, data)
                                } catch e {
                                    print("  ‚ö†Ô∏è  –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ", quarter_file, ": ", e)
                                }
                            }
                            
                            if contains(quarter_file.name, "product_summary_") {
                                try {
                                    all_product_summary_tables = push(all_product_summary_tables, data)
                                } catch e {
                                    print("  ‚ö†Ô∏è  –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ", quarter_file, ": ", e)
                                }
                            }
                            
                            if contains(quarter_file.name, "employee_performance_") {
                                try {
                                    all_employee_performance_tables = push(all_employee_performance_tables, data)
                                } catch e {
                                    print("  ‚ö†Ô∏è  –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ", quarter_file, ": ", e)
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}

print("  ‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ñ–∞–π–ª–æ–≤ financial_summary: ", len(all_financial_summary_tables))
print("  ‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ñ–∞–π–ª–æ–≤ regional_summary: ", len(all_regional_summary_tables))
print("  ‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ñ–∞–π–ª–æ–≤ product_summary: ", len(all_product_summary_tables))
print("  ‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ñ–∞–π–ª–æ–≤ employee_performance: ", len(all_employee_performance_tables))
print()

# –û–±—ä–µ–¥–∏–Ω—è–µ–º –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
print("üîó –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö...")
global financial_summary_all = merge_tables(all_financial_summary_tables)
global regional_summary_all = merge_tables(all_regional_summary_tables)
global product_summary_all = merge_tables(all_product_summary_tables)
global employee_performance_all = merge_tables(all_employee_performance_tables)

if financial_summary_all != null {
    print("  ‚úì –û–±—ä–µ–¥–∏–Ω–µ–Ω–æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Å–≤–æ–¥–æ–≤: ", len(financial_summary_all))
}
if regional_summary_all != null {
    print("  ‚úì –û–±—ä–µ–¥–∏–Ω–µ–Ω–æ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Å–≤–æ–¥–æ–≤: ", len(regional_summary_all))
}
if product_summary_all != null {
    print("  ‚úì –û–±—ä–µ–¥–∏–Ω–µ–Ω–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã—Ö —Å–≤–æ–¥–æ–≤: ", len(product_summary_all))
}
if employee_performance_all != null {
    print("  ‚úì –û–±—ä–µ–¥–∏–Ω–µ–Ω–æ –æ—Ç—á–µ—Ç–æ–≤ –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º: ", len(employee_performance_all))
}
print()

# –°–æ–∑–¥–∞–Ω–∏–µ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏
print("üîó –°–æ–∑–¥–∞–Ω–∏–µ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏...")
let relations_created = 0

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è —Å–≤—è–∑–∏
fn create_relation(table1, col1, table2, col2, relation_name) {
    try {
        let headers1 = table1.columns
        let headers2 = table2.columns

        if col1 in headers1 and col2 in headers2 {
            relate(table1[col1], table2[col2])
            print("  ‚úì ", relation_name)
            return true
        } else {
            print("  ‚ö†Ô∏è  ", relation_name, " - –∫–æ–ª–æ–Ω–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")
            return false
        }
    } catch e {
        print("  ‚úó ", relation_name, " - –æ—à–∏–±–∫–∞: ", e)
        return false
    }
}

# –°–≤—è–∑–∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ —Å –µ–∂–µ–º–µ—Å—è—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
if sales_all != null {
    if product_catalog != null {
        if create_relation(product_catalog, "product_id", sales_all, "product_id", "product_catalog.product_id ‚Üî sales_all.product_id") {
            relations_created = relations_created + 1
        }
    }
    
    if regions != null {
        if create_relation(regions, "region_code", sales_all, "region", "regions.region_code ‚Üî sales_all.region") {
            relations_created = relations_created + 1
        }
    }
    
    if employees != null {
        if create_relation(employees, "employee_id", sales_all, "employee_id", "employees.employee_id ‚Üî sales_all.employee_id") {
            relations_created = relations_created + 1
        }
    }
}

if inventory_all != null {
    if product_catalog != null {
        if create_relation(product_catalog, "product_id", inventory_all, "product_id", "product_catalog.product_id ‚Üî inventory_all.product_id") {
            relations_created = relations_created + 1
        }
    }
    
    if regions != null {
        if create_relation(regions, "region_code", inventory_all, "region", "regions.region_code ‚Üî inventory_all.region") {
            relations_created = relations_created + 1
        }
    }
}

if refunds_all != null {
    if sales_all != null {
        if create_relation(sales_all, "transaction_id", refunds_all, "transaction_id", "sales_all.transaction_id ‚Üî refunds_all.transaction_id") {
            relations_created = relations_created + 1
        }
    }
    
    if product_catalog != null {
        if create_relation(product_catalog, "product_id", refunds_all, "product_id", "product_catalog.product_id ‚Üî refunds_all.product_id") {
            relations_created = relations_created + 1
        }
    }
    
    if regions != null {
        if create_relation(regions, "region_code", refunds_all, "region", "regions.region_code ‚Üî refunds_all.region") {
            relations_created = relations_created + 1
        }
    }
}

if marketing_spend_all != null {
    if regions != null {
        if create_relation(regions, "region_code", marketing_spend_all, "region", "regions.region_code ‚Üî marketing_spend_all.region") {
            relations_created = relations_created + 1
        }
    }
}

# –°–≤—è–∑–∏ —Å –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–º–∏ –∞–≥—Ä–µ–≥–∞—Ç–∞–º–∏
if product_summary_all != null {
    if product_catalog != null {
        if create_relation(product_catalog, "product_id", product_summary_all, "product_id", "product_catalog.product_id ‚Üî product_summary_all.product_id") {
            relations_created = relations_created + 1
        }
    }
}

if regional_summary_all != null {
    if regions != null {
        if create_relation(regions, "region_code", regional_summary_all, "region", "regions.region_code ‚Üî regional_summary_all.region") {
            relations_created = relations_created + 1
        }
    }
}

if employee_performance_all != null {
    if employees != null {
        if create_relation(employees, "employee_id", employee_performance_all, "employee_id", "employees.employee_id ‚Üî employee_performance_all.employee_id") {
            relations_created = relations_created + 1
        }
    }
}

print("  ‚úì –°–æ–∑–¥–∞–Ω–æ —Å–≤—è–∑–µ–π: ", relations_created)
print()

# –ü—Ä–æ–≤–µ—Ä–∫–∞: –≤—ã–∑–æ–≤ relate() –Ω–∞–ø—Ä—è–º—É—é –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
if product_catalog != null and sales_all != null {
    print("üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞: –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ relate()...")
    try {
        relate(product_catalog["product_id"], sales_all["product_id"])
        print("  ‚úì relate() –≤—ã–∑–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ")
    } catch e {
        print("  ‚úó –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ relate(): ", e)
    }
}
print()

print("============================================================")
print("‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∞!")
print("============================================================")
print()
print("üìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
print("  ‚Ä¢ –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏:")
if product_catalog != null {
    print("    - product_catalog: ", len(product_catalog), " —Å—Ç—Ä–æ–∫")
}
if regions != null {
    print("    - regions: ", len(regions), " —Å—Ç—Ä–æ–∫")
}
if employees != null {
    print("    - employees: ", len(employees), " —Å—Ç—Ä–æ–∫")
}
print("  ‚Ä¢ –ï–∂–µ–º–µ—Å—è—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:")
if sales_all != null {
    print("    - sales_all: ", len(sales_all), " —Å—Ç—Ä–æ–∫")
}
if inventory_all != null {
    print("    - inventory_all: ", len(inventory_all), " —Å—Ç—Ä–æ–∫")
}
if refunds_all != null {
    print("    - refunds_all: ", len(refunds_all), " —Å—Ç—Ä–æ–∫")
}
if marketing_spend_all != null {
    print("    - marketing_spend_all: ", len(marketing_spend_all), " —Å—Ç—Ä–æ–∫")
}
print("  ‚Ä¢ –ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –∞–≥—Ä–µ–≥–∞—Ç—ã:")
if financial_summary_all != null {
    print("    - financial_summary_all: ", len(financial_summary_all), " —Å—Ç—Ä–æ–∫")
}
if regional_summary_all != null {
    print("    - regional_summary_all: ", len(regional_summary_all), " —Å—Ç—Ä–æ–∫")
}
if product_summary_all != null {
    print("    - product_summary_all: ", len(product_summary_all), " —Å—Ç—Ä–æ–∫")
}
if employee_performance_all != null {
    print("    - employee_performance_all: ", len(employee_performance_all), " —Å—Ç—Ä–æ–∫")
}
print("  ‚Ä¢ –°–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏:")
print("    - –°–æ–∑–¥–∞–Ω–æ —Å–≤—è–∑–µ–π: ", relations_created)
print()
print("üí° –î–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ SQLite –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ: datacode –∑–∞–≥—Ä—É–∑–∫–∞_–¥–∞–Ω–Ω—ã—Ö_–º–æ–¥–µ–ª–∏.dc --build_model")
print()
